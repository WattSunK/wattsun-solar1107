<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Flexible Solar Financing Options</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link href="main.css" rel="stylesheet"/>
<style>
    /* Fix hamburger alignment */
    .header-bar {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .nav-toggle {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      display: flex !important;
      cursor: pointer;
      background: none;
      border: none;
      font-size: 2.2em;
      color: #fff;
      height: 44px;
      width: 44px;
      align-items: center;
      justify-content: center;
    }

    /* Mobile nav toggle */
    @media (max-width: 700px) {
      nav {
        display: none;
      }
      header.nav-open nav {
        display: flex !important;
        flex-direction: column;
        background: #ffc947;
        padding-bottom: 8px;
        border-top: 1.5px solid #ffd67a;
      }
      nav a {
        color: #fff;
        padding: 12px 34px;
        border-bottom: 1px solid #f2e2b6;
        font-weight: 700;
      }
      nav a:last-child {
        border-bottom: none;
      }
    }

    /* Other styles */
    body {
      background: #f7f7f7;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      color: #333;
    }
    .container {
      max-width: 700px;
      margin: 40px auto;
      background: #fff;
      padding: 40px 35px 30px 35px;
      border-radius: 12px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.10);
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 2em;
      font-weight: bold;
      letter-spacing: 0.1px;
    }
    p {
      font-size: 1.13em;
      line-height: 1.5;
      margin-bottom: 28px;
      text-align: center;
    }
    label {
      display: block;
      margin: 15px 0 6px 0;
      font-weight: bold;
      font-size: 1.11em;
    }
    input, select {
      width: 100%;
      padding: 13px 12px;
      margin-bottom: 13px;
      border: 1.2px solid #ccc;
      border-radius: 5px;
      font-size: 1em;
      box-sizing: border-box;
      background: #faf9f7;
      transition: border-color 0.2s;
    }
    input:focus, select:focus {
      border-color: #f7b733;
      outline: none;
    }
    button {
      width: 100%;
      background: #ffc043;
      color: #fff;
      border: none;
      padding: 15px;
      border-radius: 6px;
      font-size: 1.15em;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      margin-top: 10px;
      margin-bottom: 8px;
      box-shadow: 0 3px 18px rgba(247,183,51,0.11);
      letter-spacing: 0.04em;
    }
    button:hover {
      background: #ffb347;
      color: #965700;
    }
    .result {
      margin-top: 18px;
      text-align: center;
      font-weight: bold;
      font-size: 1.16em;
    }
    .disclaimer {
      font-size: 0.98em;
      text-align: center;
      color: #888;
      margin-top: 14px;
    }
    @media (max-width: 800px) {
      .container {
        max-width: 98vw;
        padding: 22px 5vw;
      }
    }
  
    .cart-btn { background: #ffc043; color: white; font-weight: bold; border: none; border-radius: 6px; cursor: pointer; box-shadow: 0 3px 12px rgba(0,0,0,0.06); }</style>
</head>
<body>
<header>
<div class="header-bar">
<h1>WattSun Solar</h1>
<button aria-label="Open menu" class="nav-toggle" onclick="toggleNav()">â˜°</button>
</div>
<nav>
<a href="index.html">Home</a>
<a href="solutions.html">Solutions</a>
<a href="shop.html">Shop</a>
<a aria-current="page" class="active" href="financing.html">Financing</a>
<a href="projects.html">Projects</a>
<a href="contact.html">Contact</a>
<span id="cartLinkWrapper" style="display:none;">
<a href="cart.html">
    ðŸ›’ Cart <span id="cartCount" style="font-weight:bold; background:#3E9F50; color:white; padding:2px 6px; border-radius:50%; font-size:0.8em; vertical-align:top;">0</span>
</a>
</span>
</nav>
</header>
<div class="container">
<h2>Flexible Solar Financing Options</h2>
<p>
    WattSun Solar offers tailored financing plans to help you transition to clean, renewable energy without the burden of large upfront costs. Use the estimator below to calculate your expected monthly repayment based on system size and interest terms.
  </p>
<form id="loanForm">
<label for="system">Select System Size:</label>
<select id="system" required="">
<option value="">-- Select --</option>
<option value="150000">1 kW â€“ KES 150,000</option>
<option value="400000">3 kW â€“ KES 400,000</option>
<option value="700000">6 kW â€“ KES 700,000</option>
<option value="1050000">9 kW â€“ KES 1,050,000</option>
<option value="1420000">12â€¯kW â€“ KES 1,420,000</option>
</select>
<label for="deposit">Your Deposit (KES):</label>
<input id="deposit" min="0" required="" type="number"/>
<label for="term">Loan Term (Months):</label>
<input id="term" max="36" min="6" required="" type="number" value="36"/>
<button type="submit">Calculate Loan</button>
</form>
<div class="result" id="result"></div>
<div class="disclaimer">* This is an indicative estimate. Actual loan terms may vary.</div>
</div>
<footer>
  Â© 2025 WattSun Solar Kenya | <div class="footer-contacts"><a href="mailto:info@wattsun.co.ke">info@wattsun.co.ke</a></div>
</footer>
<script>
  function toggleNav() {
    document.querySelector('header').classList.toggle('nav-open');
  }
  document.getElementById('loanForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const price = parseFloat(document.getElementById('system').value);
    const deposit = parseFloat(document.getElementById('deposit').value);
    const term = parseInt(document.getElementById('term').value);
    const resultDiv = document.getElementById('result');
    if (!price || isNaN(deposit) || isNaN(term)) {
      resultDiv.textContent = "Please fill in all fields.";
      return;
    }
    const minDeposit = 0.5 * price;
    if (deposit < minDeposit) {
      resultDiv.textContent = "Minimum deposit is KES " + minDeposit.toLocaleString("en-KE");
      return;
    }
    if (deposit > price) {
      resultDiv.textContent = "Deposit cannot be greater than system cost (KES " + price.toLocaleString("en-KE") + ")";
      return;
    }
    const loanAmount = price - deposit;
    const annualInterestRate = 0.15;
    const monthlyInterestRate = annualInterestRate / 12;
    const monthlyRepayment = (loanAmount * monthlyInterestRate) / (1 - Math.pow(1 + monthlyInterestRate, -term));
    resultDiv.textContent =
      "Loan Amount: KES " + loanAmount.toLocaleString("en-KE") +
      " | Monthly Repayment: KES " + monthlyRepayment.toFixed(0).toLocaleString("en-KE");
    localStorage.setItem('loanKit', JSON.stringify({
      system: document.getElementById('system').selectedOptions[0].text,
      price: price,
      deposit: deposit,
      loanAmount: loanAmount,
      term: term,
      monthly: monthlyRepayment.toFixed(0)
    }));

    if (!document.getElementById('addToCartBtn')) {
      const btn = document.createElement('button');
      btn.textContent = "Add to Cart";
      btn.id = "addToCartBtn";
      btn.className = "cart-btn"; // use site formatting
      btn.style.margin = '14px auto 0';
      btn.style.display = 'block';
      btn.style.padding = '12px 28px';
      btn.onclick = function() {
        const kit = JSON.parse(localStorage.getItem('loanKit'));
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        cart.push({
          name: "Loan Kit â€“ " + kit.system,
          price: kit.price,
          deposit: kit.deposit,
          term: kit.term,
          monthly: kit.monthly
        });
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount?.();
        btn.remove();
        document.getElementById('loanForm').reset();
        resultDiv.textContent = "Loan added to cart!";
      };
      document.querySelector('.disclaimer').after(btn);
    }

  });
</script>
<script>
  function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const count = cart.length;
    const badge = document.getElementById("cartCount");
    if (badge) badge.textContent = count;
  }

  document.addEventListener("DOMContentLoaded", function () {
    const page = window.location.pathname.toLowerCase();
    if (page.includes("shop") || page.includes("cart") || page.includes("checkout") || page.includes("financing")) {
      const wrapper = document.getElementById("cartLinkWrapper");
      if (wrapper) {
        wrapper.style.display = "inline-block";
        updateCartCount();
      }
    }
  });
</script>
</body>
</html>
